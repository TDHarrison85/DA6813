<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Case Study 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Case_Study_1_Sandbox_files/libs/clipboard/clipboard.min.js"></script>
<script src="Case_Study_1_Sandbox_files/libs/quarto-html/quarto.js"></script>
<script src="Case_Study_1_Sandbox_files/libs/quarto-html/popper.min.js"></script>
<script src="Case_Study_1_Sandbox_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Case_Study_1_Sandbox_files/libs/quarto-html/anchor.min.js"></script>
<link href="Case_Study_1_Sandbox_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Case_Study_1_Sandbox_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Case_Study_1_Sandbox_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Case_Study_1_Sandbox_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Case_Study_1_Sandbox_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Case Study 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="case-study-1" class="level2">
<h2 class="anchored" data-anchor-id="case-study-1">Case Study 1</h2>
<p>NOTES: —Create template (TIM) for write up - fill in tuesday —ask about the balance in specificity/ sensitivity chart (HOLLY)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(MASS, tidyverse, here, car, corrplot, skimr, caret, ROCR, dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">'Case Study 1'</span>,<span class="st">'bank-additional.csv'</span>), <span class="at">sep =</span> <span class="st">';'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age         job marital         education default housing    loan   contact
1  30 blue-collar married          basic.9y      no     yes      no  cellular
2  39    services  single       high.school      no      no      no telephone
3  25    services married       high.school      no     yes      no telephone
4  38    services married          basic.9y      no unknown unknown telephone
5  47      admin. married university.degree      no     yes      no  cellular
6  32    services  single university.degree      no      no      no  cellular
  month day_of_week duration campaign pdays previous    poutcome emp.var.rate
1   may         fri      487        2   999        0 nonexistent         -1.8
2   may         fri      346        4   999        0 nonexistent          1.1
3   jun         wed      227        1   999        0 nonexistent          1.4
4   jun         fri       17        3   999        0 nonexistent          1.4
5   nov         mon       58        1   999        0 nonexistent         -0.1
6   sep         thu      128        3   999        2     failure         -1.1
  cons.price.idx cons.conf.idx euribor3m nr.employed  y
1         92.893         -46.2     1.313      5099.1 no
2         93.994         -36.4     4.855      5191.0 no
3         94.465         -41.8     4.962      5228.1 no
4         94.465         -41.8     4.959      5228.1 no
5         93.200         -42.0     4.191      5195.8 no
6         94.199         -37.5     0.884      4963.6 no</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">4119</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">job</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">marital</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">default</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">housing</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">loan</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contact</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">day_of_week</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">poutcome</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40.11</td>
<td style="text-align: right;">10.31</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">32.00</td>
<td style="text-align: right;">38.00</td>
<td style="text-align: right;">47.00</td>
<td style="text-align: right;">88.00</td>
<td style="text-align: left;">▅▇▅▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">256.79</td>
<td style="text-align: right;">254.70</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">103.00</td>
<td style="text-align: right;">181.00</td>
<td style="text-align: right;">317.00</td>
<td style="text-align: right;">3643.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">campaign</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.54</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">35.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">pdays</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">960.42</td>
<td style="text-align: right;">191.92</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">999.00</td>
<td style="text-align: right;">999.00</td>
<td style="text-align: right;">999.00</td>
<td style="text-align: right;">999.00</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">previous</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">emp.var.rate</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">-3.40</td>
<td style="text-align: right;">-1.80</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: left;">▁▃▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cons.price.idx</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">93.58</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">92.20</td>
<td style="text-align: right;">93.08</td>
<td style="text-align: right;">93.75</td>
<td style="text-align: right;">93.99</td>
<td style="text-align: right;">94.77</td>
<td style="text-align: left;">▁▆▃▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">cons.conf.idx</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-40.50</td>
<td style="text-align: right;">4.59</td>
<td style="text-align: right;">-50.80</td>
<td style="text-align: right;">-42.70</td>
<td style="text-align: right;">-41.80</td>
<td style="text-align: right;">-36.40</td>
<td style="text-align: right;">-26.90</td>
<td style="text-align: left;">▅▇▁▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">euribor3m</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.62</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">4.96</td>
<td style="text-align: right;">5.04</td>
<td style="text-align: left;">▅▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">nr.employed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5166.48</td>
<td style="text-align: right;">73.67</td>
<td style="text-align: right;">4963.60</td>
<td style="text-align: right;">5099.10</td>
<td style="text-align: right;">5191.00</td>
<td style="text-align: right;">5228.10</td>
<td style="text-align: right;">5228.10</td>
<td style="text-align: left;">▁▁▃▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df2<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "no"  "yes"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcontact =</span> <span class="fu">ifelse</span>(pdays <span class="sc">==</span> <span class="dv">999</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">ifelse</span>(y <span class="sc">==</span> <span class="st">'yes'</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>pdays)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   4119 obs. of  21 variables:
 $ age           : int  30 39 25 38 47 32 32 41 31 35 ...
 $ job           : Factor w/ 12 levels "admin.","blue-collar",..: 2 8 8 8 1 8 1 3 8 2 ...
 $ marital       : Factor w/ 4 levels "divorced","married",..: 2 3 2 2 2 3 3 2 1 2 ...
 $ education     : Factor w/ 8 levels "basic.4y","basic.6y",..: 3 4 4 3 7 7 7 7 6 3 ...
 $ default       : Factor w/ 3 levels "no","unknown",..: 1 1 1 1 1 1 1 2 1 2 ...
 $ housing       : Factor w/ 3 levels "no","unknown",..: 3 1 3 2 3 1 3 3 1 1 ...
 $ loan          : Factor w/ 3 levels "no","unknown",..: 1 1 1 2 1 1 1 1 1 1 ...
 $ contact       : Factor w/ 2 levels "cellular","telephone": 1 2 2 2 1 1 1 1 1 2 ...
 $ month         : Factor w/ 10 levels "apr","aug","dec",..: 7 7 5 5 8 10 10 8 8 7 ...
 $ day_of_week   : Factor w/ 5 levels "fri","mon","thu",..: 1 1 5 1 2 3 2 2 4 3 ...
 $ duration      : int  487 346 227 17 58 128 290 44 68 170 ...
 $ campaign      : int  2 4 1 3 1 3 4 2 1 1 ...
 $ previous      : int  0 0 0 0 0 2 0 0 1 0 ...
 $ poutcome      : Factor w/ 3 levels "failure","nonexistent",..: 2 2 2 2 2 1 2 2 1 2 ...
 $ emp.var.rate  : num  -1.8 1.1 1.4 1.4 -0.1 -1.1 -1.1 -0.1 -0.1 1.1 ...
 $ cons.price.idx: num  92.9 94 94.5 94.5 93.2 ...
 $ cons.conf.idx : num  -46.2 -36.4 -41.8 -41.8 -42 -37.5 -37.5 -42 -42 -36.4 ...
 $ euribor3m     : num  1.31 4.86 4.96 4.96 4.19 ...
 $ nr.employed   : num  5099 5191 5228 5228 5196 ...
 $ y             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ pcontact      : num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df2<span class="sc">$</span>education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "basic.4y"            "basic.6y"            "basic.9y"           
[4] "high.school"         "illiterate"          "professional.course"
[7] "university.degree"   "unknown"            </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> campaign)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">x =</span> previous)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">'fill'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">x =</span> previous)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> emp.var.rate)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> cons.price.idx)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> cons.conf.idx)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> euribor3m)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> nr.employed)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> job)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> marital)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> education)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> default)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> housing)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> loan)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> contact)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> month)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> day_of_week)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(y), <span class="at">y =</span> poutcome)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(y) <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">resp_cnt =</span> <span class="fu">n</span>()</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
      y resp_cnt
  &lt;dbl&gt;    &lt;int&gt;
1     0     3668
2     1      451</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cor1 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> <span class="fu">cor</span>()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>duration)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing samples</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting seed locks the random number generator. </span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>trn_part <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(df4),<span class="fl">0.8</span><span class="sc">*</span><span class="fu">nrow</span>(df4),<span class="at">replace =</span> F) <span class="co"># Setting training sample to be 80% of the data</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>dftrain <span class="ot">&lt;-</span> df4[trn_part,]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>dftest <span class="ot">&lt;-</span> df4[<span class="sc">-</span>trn_part,]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># With logistic regression</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>m1.log <span class="ot">=</span> <span class="fu">glm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> dftrain, <span class="at">family =</span> binomial)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.log) <span class="do">## look at results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ ., family = binomial, data = dftrain)

Coefficients: (1 not defined because of singularities)
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -1.626e+02  1.205e+02  -1.350  0.17706    
age                           1.232e-02  7.646e-03   1.611  0.10712    
jobblue-collar               -4.796e-01  2.484e-01  -1.931  0.05348 .  
jobentrepreneur              -6.000e-01  4.329e-01  -1.386  0.16574    
jobhousemaid                 -1.242e-01  4.125e-01  -0.301  0.76330    
jobmanagement                -6.556e-01  2.760e-01  -2.375  0.01753 *  
jobretired                   -2.700e-01  3.474e-01  -0.777  0.43711    
jobself-employed             -6.753e-01  3.745e-01  -1.803  0.07135 .  
jobservices                  -2.703e-01  2.651e-01  -1.020  0.30792    
jobstudent                   -1.222e-02  3.800e-01  -0.032  0.97435    
jobtechnician                -1.446e-01  2.110e-01  -0.685  0.49322    
jobunemployed                -3.189e-01  4.001e-01  -0.797  0.42536    
jobunknown                   -2.386e-01  6.959e-01  -0.343  0.73173    
maritalmarried                1.788e-01  2.255e-01   0.793  0.42783    
maritalsingle                 1.335e-01  2.594e-01   0.515  0.60686    
maritalunknown                7.015e-01  1.103e+00   0.636  0.52491    
educationbasic.6y             1.916e-01  3.859e-01   0.497  0.61947    
educationbasic.9y             1.280e-01  2.982e-01   0.429  0.66763    
educationhigh.school          3.467e-02  2.879e-01   0.120  0.90416    
educationilliterate          -1.219e+01  5.354e+02  -0.023  0.98183    
educationprofessional.course  2.588e-01  3.112e-01   0.832  0.40559    
educationuniversity.degree    1.929e-01  2.873e-01   0.671  0.50196    
educationunknown             -3.751e-02  3.848e-01  -0.097  0.92234    
defaultunknown                1.256e-01  1.904e-01   0.660  0.50931    
defaultyes                   -1.010e+01  5.354e+02  -0.019  0.98495    
housingunknown               -3.784e-01  4.684e-01  -0.808  0.41912    
housingyes                   -9.249e-02  1.302e-01  -0.710  0.47757    
loanunknown                          NA         NA      NA       NA    
loanyes                      -1.324e-02  1.716e-01  -0.077  0.93848    
contacttelephone             -1.127e+00  2.653e-01  -4.248 2.16e-05 ***
monthaug                     -6.116e-02  4.123e-01  -0.148  0.88208    
monthdec                      6.300e-01  6.218e-01   1.013  0.31096    
monthjul                      1.050e-01  3.429e-01   0.306  0.75945    
monthjun                      1.035e-01  4.211e-01   0.246  0.80584    
monthmar                      1.579e+00  5.204e-01   3.034  0.00241 ** 
monthmay                     -2.370e-01  2.813e-01  -0.842  0.39954    
monthnov                     -4.584e-01  3.916e-01  -1.171  0.24174    
monthoct                     -2.488e-01  5.053e-01  -0.492  0.62238    
monthsep                     -2.581e-01  5.914e-01  -0.436  0.66251    
day_of_weekmon               -6.642e-02  2.002e-01  -0.332  0.74000    
day_of_weekthu                3.339e-03  2.012e-01   0.017  0.98676    
day_of_weektue                1.256e-02  2.050e-01   0.061  0.95113    
day_of_weekwed                9.504e-02  2.111e-01   0.450  0.65253    
campaign                     -7.445e-02  3.755e-02  -1.983  0.04740 *  
previous                      2.409e-02  1.816e-01   0.133  0.89449    
poutcomenonexistent           4.304e-01  2.951e-01   1.458  0.14472    
poutcomesuccess               9.983e-01  6.598e-01   1.513  0.13031    
emp.var.rate                 -9.529e-01  4.564e-01  -2.088  0.03680 *  
cons.price.idx                1.586e+00  7.956e-01   1.994  0.04616 *  
cons.conf.idx                 6.095e-02  2.643e-02   2.306  0.02110 *  
euribor3m                     6.953e-03  4.078e-01   0.017  0.98640    
nr.employed                   2.707e-03  9.721e-03   0.278  0.78063    
pcontact                      7.649e-01  6.590e-01   1.161  0.24579    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2314.9  on 3294  degrees of freedom
Residual deviance: 1796.6  on 3243  degrees of freedom
AIC: 1900.6

Number of Fisher Scoring iterations: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#vif(m1.log) # double check multicollinearity, returns error</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">alias</span>(m1.log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model :
y ~ age + job + marital + education + default + housing + loan + 
    contact + month + day_of_week + campaign + previous + poutcome + 
    emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + 
    nr.employed + pcontact

Complete :
            (Intercept) age jobblue-collar jobentrepreneur jobhousemaid
loanunknown 0           0   0              0               0           
            jobmanagement jobretired jobself-employed jobservices jobstudent
loanunknown 0             0          0                0           0         
            jobtechnician jobunemployed jobunknown maritalmarried maritalsingle
loanunknown 0             0             0          0              0            
            maritalunknown educationbasic.6y educationbasic.9y
loanunknown 0              0                 0                
            educationhigh.school educationilliterate
loanunknown 0                    0                  
            educationprofessional.course educationuniversity.degree
loanunknown 0                            0                         
            educationunknown defaultunknown defaultyes housingunknown
loanunknown 0                0              0          1             
            housingyes loanyes contacttelephone monthaug monthdec monthjul
loanunknown 0          0       0                0        0        0       
            monthjun monthmar monthmay monthnov monthoct monthsep
loanunknown 0        0        0        0        0        0       
            day_of_weekmon day_of_weekthu day_of_weektue day_of_weekwed
loanunknown 0              0              0              0             
            campaign previous poutcomenonexistent poutcomesuccess emp.var.rate
loanunknown 0        0        0                   0               0           
            cons.price.idx cons.conf.idx euribor3m nr.employed pcontact
loanunknown 0              0             0         0           0       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>m2.log <span class="ot">=</span> <span class="fu">glm</span>(y <span class="sc">~</span> .<span class="sc">-</span>housing, <span class="at">data =</span> dftrain, <span class="at">family =</span> binomial)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.log) <span class="do">## look at results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ . - housing, family = binomial, data = dftrain)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -1.647e+02  1.205e+02  -1.367  0.17170    
age                           1.237e-02  7.648e-03   1.618  0.10568    
jobblue-collar               -4.751e-01  2.483e-01  -1.913  0.05572 .  
jobentrepreneur              -6.019e-01  4.332e-01  -1.389  0.16472    
jobhousemaid                 -1.198e-01  4.117e-01  -0.291  0.77106    
jobmanagement                -6.543e-01  2.761e-01  -2.370  0.01780 *  
jobretired                   -2.732e-01  3.476e-01  -0.786  0.43185    
jobself-employed             -6.639e-01  3.733e-01  -1.778  0.07536 .  
jobservices                  -2.665e-01  2.652e-01  -1.005  0.31495    
jobstudent                   -1.707e-03  3.796e-01  -0.004  0.99641    
jobtechnician                -1.436e-01  2.109e-01  -0.681  0.49593    
jobunemployed                -3.193e-01  4.004e-01  -0.797  0.42526    
jobunknown                   -2.566e-01  6.952e-01  -0.369  0.71211    
maritalmarried                1.812e-01  2.254e-01   0.804  0.42148    
maritalsingle                 1.369e-01  2.592e-01   0.528  0.59750    
maritalunknown                7.080e-01  1.102e+00   0.642  0.52069    
educationbasic.6y             1.778e-01  3.854e-01   0.461  0.64451    
educationbasic.9y             1.185e-01  2.978e-01   0.398  0.69054    
educationhigh.school          2.986e-02  2.877e-01   0.104  0.91733    
educationilliterate          -1.213e+01  5.354e+02  -0.023  0.98192    
educationprofessional.course  2.532e-01  3.107e-01   0.815  0.41515    
educationuniversity.degree    1.848e-01  2.870e-01   0.644  0.51958    
educationunknown             -4.973e-02  3.847e-01  -0.129  0.89716    
defaultunknown                1.244e-01  1.904e-01   0.654  0.51329    
defaultyes                   -1.004e+01  5.354e+02  -0.019  0.98503    
loanunknown                  -3.285e-01  4.631e-01  -0.709  0.47807    
loanyes                      -2.122e-02  1.711e-01  -0.124  0.90129    
contacttelephone             -1.132e+00  2.653e-01  -4.265    2e-05 ***
monthaug                     -5.754e-02  4.125e-01  -0.140  0.88905    
monthdec                      6.451e-01  6.212e-01   1.038  0.29907    
monthjul                      1.115e-01  3.427e-01   0.325  0.74487    
monthjun                      1.078e-01  4.211e-01   0.256  0.79796    
monthmar                      1.575e+00  5.204e-01   3.027  0.00247 ** 
monthmay                     -2.268e-01  2.809e-01  -0.807  0.41949    
monthnov                     -4.587e-01  3.916e-01  -1.171  0.24148    
monthoct                     -2.384e-01  5.053e-01  -0.472  0.63703    
monthsep                     -2.540e-01  5.915e-01  -0.429  0.66759    
day_of_weekmon               -6.560e-02  2.001e-01  -0.328  0.74301    
day_of_weekthu                4.649e-04  2.011e-01   0.002  0.99816    
day_of_weektue                7.457e-03  2.049e-01   0.036  0.97096    
day_of_weekwed                9.104e-02  2.110e-01   0.432  0.66609    
campaign                     -7.421e-02  3.750e-02  -1.979  0.04784 *  
previous                      2.012e-02  1.810e-01   0.111  0.91150    
poutcomenonexistent           4.256e-01  2.946e-01   1.445  0.14854    
poutcomesuccess               9.904e-01  6.583e-01   1.504  0.13246    
emp.var.rate                 -9.622e-01  4.563e-01  -2.109  0.03495 *  
cons.price.idx                1.603e+00  7.953e-01   2.016  0.04380 *  
cons.conf.idx                 6.125e-02  2.643e-02   2.317  0.02051 *  
euribor3m                     1.070e-02  4.077e-01   0.026  0.97906    
nr.employed                   2.779e-03  9.721e-03   0.286  0.77495    
pcontact                      7.730e-01  6.576e-01   1.175  0.23980    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2314.9  on 3294  degrees of freedom
Residual deviance: 1797.1  on 3244  degrees of freedom
AIC: 1899.1

Number of Fisher Scoring iterations: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m2.log) <span class="co"># double check multicollinearity, finds correlated var: nr.employed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     GVIF Df GVIF^(1/(2*Df))
age              2.100071  1        1.449162
job              6.103920 11        1.085699
marital          1.523710  3        1.072713
education        3.593704  7        1.095675
default          1.164362  2        1.038776
loan             1.058570  2        1.014331
contact          2.923484  1        1.709820
month           97.979596  9        1.290086
day_of_week      1.142381  4        1.016778
campaign         1.057917  1        1.028551
previous         4.608773  1        2.146805
poutcome        20.978053  2        2.140136
emp.var.rate   157.465522  1       12.548527
cons.price.idx  71.553282  1        8.458917
cons.conf.idx    5.959022  1        2.441111
euribor3m      143.446657  1       11.976922
nr.employed    182.925796  1       13.525006
pcontact         8.714499  1        2.952033</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m3.log <span class="ot">=</span> <span class="fu">glm</span>(y <span class="sc">~</span> .<span class="sc">-</span>housing <span class="sc">-</span>nr.employed, <span class="at">data =</span> dftrain, <span class="at">family =</span> binomial)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3.log) <span class="do">## look at results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ . - housing - nr.employed, family = binomial, 
    data = dftrain)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -1.314e+02  3.164e+01  -4.154 3.27e-05 ***
age                           1.246e-02  7.641e-03   1.631 0.102899    
jobblue-collar               -4.732e-01  2.482e-01  -1.907 0.056582 .  
jobentrepreneur              -5.957e-01  4.325e-01  -1.378 0.168344    
jobhousemaid                 -1.212e-01  4.120e-01  -0.294 0.768655    
jobmanagement                -6.497e-01  2.755e-01  -2.358 0.018382 *  
jobretired                   -2.724e-01  3.474e-01  -0.784 0.433039    
jobself-employed             -6.676e-01  3.736e-01  -1.787 0.073933 .  
jobservices                  -2.658e-01  2.653e-01  -1.002 0.316248    
jobstudent                   -4.042e-03  3.798e-01  -0.011 0.991508    
jobtechnician                -1.445e-01  2.109e-01  -0.685 0.493306    
jobunemployed                -3.169e-01  4.003e-01  -0.792 0.428550    
jobunknown                   -2.590e-01  6.964e-01  -0.372 0.709920    
maritalmarried                1.797e-01  2.253e-01   0.797 0.425210    
maritalsingle                 1.370e-01  2.592e-01   0.529 0.597132    
maritalunknown                7.016e-01  1.102e+00   0.637 0.524263    
educationbasic.6y             1.800e-01  3.853e-01   0.467 0.640307    
educationbasic.9y             1.211e-01  2.977e-01   0.407 0.684100    
educationhigh.school          3.108e-02  2.877e-01   0.108 0.913969    
educationilliterate          -1.211e+01  5.354e+02  -0.023 0.981953    
educationprofessional.course  2.532e-01  3.108e-01   0.815 0.415132    
educationuniversity.degree    1.847e-01  2.870e-01   0.644 0.519776    
educationunknown             -4.377e-02  3.840e-01  -0.114 0.909246    
defaultunknown                1.252e-01  1.904e-01   0.658 0.510841    
defaultyes                   -1.004e+01  5.354e+02  -0.019 0.985032    
loanunknown                  -3.270e-01  4.633e-01  -0.706 0.480283    
loanyes                      -2.262e-02  1.711e-01  -0.132 0.894818    
contacttelephone             -1.111e+00  2.541e-01  -4.372 1.23e-05 ***
monthaug                     -1.050e-01  3.777e-01  -0.278 0.780984    
monthdec                      5.809e-01  5.789e-01   1.004 0.315599    
monthjul                      1.125e-01  3.422e-01   0.329 0.742328    
monthjun                      1.754e-01  3.483e-01   0.504 0.614518    
monthmar                      1.499e+00  4.461e-01   3.360 0.000779 ***
monthmay                     -2.542e-01  2.639e-01  -0.963 0.335378    
monthnov                     -5.075e-01  3.523e-01  -1.441 0.149692    
monthoct                     -3.182e-01  4.213e-01  -0.755 0.450054    
monthsep                     -3.631e-01  4.520e-01  -0.803 0.421781    
day_of_weekmon               -6.696e-02  2.001e-01  -0.335 0.737909    
day_of_weekthu                3.283e-03  2.008e-01   0.016 0.986956    
day_of_weektue                5.307e-03  2.048e-01   0.026 0.979325    
day_of_weekwed                8.914e-02  2.109e-01   0.423 0.672584    
campaign                     -7.399e-02  3.751e-02  -1.973 0.048545 *  
previous                      2.013e-02  1.812e-01   0.111 0.911515    
poutcomenonexistent           4.217e-01  2.945e-01   1.432 0.152166    
poutcomesuccess               9.903e-01  6.584e-01   1.504 0.132542    
emp.var.rate                 -8.828e-01  3.619e-01  -2.439 0.014726 *  
cons.price.idx                1.396e+00  3.282e-01   4.254 2.10e-05 ***
cons.conf.idx                 5.625e-02  1.981e-02   2.839 0.004524 ** 
euribor3m                     9.564e-02  2.795e-01   0.342 0.732203    
pcontact                      7.728e-01  6.577e-01   1.175 0.239993    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2314.9  on 3294  degrees of freedom
Residual deviance: 1797.1  on 3245  degrees of freedom
AIC: 1897.1

Number of Fisher Scoring iterations: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m3.log) <span class="co"># double check multicollinearity, finds correlated var: emp.var.rate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF Df GVIF^(1/(2*Df))
age             2.097302  1        1.448207
job             6.040736 11        1.085186
marital         1.520745  3        1.072365
education       3.575406  7        1.095275
default         1.164461  2        1.038798
loan            1.057412  2        1.014054
contact         2.678812  1        1.636708
month          21.179329  9        1.184846
day_of_week     1.130776  4        1.015482
campaign        1.057187  1        1.028196
previous        4.614718  1        2.148189
poutcome       20.961713  2        2.139719
emp.var.rate   99.080042  1        9.953896
cons.price.idx 12.132908  1        3.483232
cons.conf.idx   3.349342  1        1.830121
euribor3m      67.412297  1        8.210499
pcontact        8.718437  1        2.952700</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>m4.log <span class="ot">=</span> <span class="fu">glm</span>(y <span class="sc">~</span> .<span class="sc">-</span>housing <span class="sc">-</span>nr.employed <span class="sc">-</span>emp.var.rate, <span class="at">data =</span> dftrain, <span class="at">family =</span> binomial)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4.log) <span class="do">## look at results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ . - housing - nr.employed - emp.var.rate, family = binomial, 
    data = dftrain)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -6.261e+01  1.415e+01  -4.426 9.62e-06 ***
age                           1.263e-02  7.625e-03   1.656  0.09771 .  
jobblue-collar               -4.943e-01  2.477e-01  -1.995  0.04601 *  
jobentrepreneur              -6.161e-01  4.328e-01  -1.423  0.15463    
jobhousemaid                 -1.434e-01  4.097e-01  -0.350  0.72639    
jobmanagement                -6.301e-01  2.736e-01  -2.304  0.02125 *  
jobretired                   -2.372e-01  3.455e-01  -0.686  0.49249    
jobself-employed             -6.416e-01  3.735e-01  -1.718  0.08582 .  
jobservices                  -2.483e-01  2.648e-01  -0.938  0.34844    
jobstudent                    4.976e-02  3.781e-01   0.132  0.89529    
jobtechnician                -1.581e-01  2.105e-01  -0.751  0.45241    
jobunemployed                -2.709e-01  3.964e-01  -0.683  0.49439    
jobunknown                   -1.954e-01  6.839e-01  -0.286  0.77503    
maritalmarried                1.646e-01  2.240e-01   0.735  0.46263    
maritalsingle                 1.249e-01  2.577e-01   0.485  0.62787    
maritalunknown                7.076e-01  1.103e+00   0.642  0.52113    
educationbasic.6y             1.985e-01  3.833e-01   0.518  0.60446    
educationbasic.9y             1.224e-01  2.967e-01   0.413  0.67983    
educationhigh.school          2.007e-02  2.864e-01   0.070  0.94412    
educationilliterate          -1.219e+01  5.354e+02  -0.023  0.98184    
educationprofessional.course  2.685e-01  3.094e-01   0.868  0.38559    
educationuniversity.degree    1.844e-01  2.860e-01   0.645  0.51918    
educationunknown             -5.274e-02  3.861e-01  -0.137  0.89133    
defaultunknown                1.242e-01  1.899e-01   0.654  0.51301    
defaultyes                   -1.003e+01  5.354e+02  -0.019  0.98505    
loanunknown                  -3.415e-01  4.601e-01  -0.742  0.45786    
loanyes                      -1.691e-02  1.708e-01  -0.099  0.92110    
contacttelephone             -1.016e+00  2.474e-01  -4.106 4.02e-05 ***
monthaug                     -4.309e-01  3.573e-01  -1.206  0.22780    
monthdec                      5.966e-01  5.785e-01   1.031  0.30234    
monthjul                      1.831e-01  3.417e-01   0.536  0.59204    
monthjun                      5.916e-01  3.065e-01   1.930  0.05355 .  
monthmar                      1.339e+00  4.603e-01   2.908  0.00363 ** 
monthmay                     -3.671e-01  2.602e-01  -1.411  0.15828    
monthnov                     -1.980e-01  3.297e-01  -0.600  0.54820    
monthoct                     -2.075e-01  4.247e-01  -0.489  0.62519    
monthsep                     -5.629e-01  4.494e-01  -1.253  0.21034    
day_of_weekmon               -7.424e-02  1.992e-01  -0.373  0.70937    
day_of_weekthu               -2.402e-02  1.998e-01  -0.120  0.90435    
day_of_weektue                4.532e-04  2.041e-01   0.002  0.99823    
day_of_weekwed                8.510e-02  2.101e-01   0.405  0.68550    
campaign                     -7.874e-02  3.752e-02  -2.099  0.03586 *  
previous                      3.586e-02  1.836e-01   0.195  0.84511    
poutcomenonexistent           4.658e-01  2.956e-01   1.576  0.11506    
poutcomesuccess               1.035e+00  6.606e-01   1.566  0.11735    
cons.price.idx                6.952e-01  1.567e-01   4.436 9.18e-06 ***
cons.conf.idx                 7.905e-02  1.794e-02   4.405 1.06e-05 ***
euribor3m                    -5.724e-01  5.769e-02  -9.921  &lt; 2e-16 ***
pcontact                      7.703e-01  6.614e-01   1.165  0.24419    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2314.9  on 3294  degrees of freedom
Residual deviance: 1803.0  on 3246  degrees of freedom
AIC: 1901

Number of Fisher Scoring iterations: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m4.log) <span class="co"># double check multicollinearity, none left over 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF Df GVIF^(1/(2*Df))
age             2.091542  1        1.446216
job             5.910931 11        1.084115
marital         1.511369  3        1.071260
education       3.550198  7        1.094722
default         1.160358  2        1.037882
loan            1.058770  2        1.014379
contact         2.503649  1        1.582292
month           7.471363  9        1.118207
day_of_week     1.123636  4        1.014678
campaign        1.054020  1        1.026655
previous        4.695375  1        2.166881
poutcome       21.200635  2        2.145790
cons.price.idx  2.792470  1        1.671068
cons.conf.idx   2.744874  1        1.656766
euribor3m       2.881734  1        1.697567
pcontact        8.860238  1        2.976615</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>m5.log <span class="ot">=</span> <span class="fu">glm</span>(y <span class="sc">~</span> .<span class="sc">-</span>housing <span class="sc">-</span>nr.employed <span class="sc">-</span>emp.var.rate <span class="sc">-</span>education, <span class="at">data =</span> dftrain, <span class="at">family =</span> binomial)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5.log) <span class="do">## look at results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ . - housing - nr.employed - emp.var.rate - 
    education, family = binomial, data = dftrain)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         -62.402778  14.091007  -4.429 9.49e-06 ***
age                   0.011905   0.007403   1.608  0.10780    
jobblue-collar       -0.524138   0.204470  -2.563  0.01037 *  
jobentrepreneur      -0.615445   0.429761  -1.432  0.15213    
jobhousemaid         -0.179477   0.394014  -0.456  0.64874    
jobmanagement        -0.612172   0.271356  -2.256  0.02407 *  
jobretired           -0.268160   0.335038  -0.800  0.42349    
jobself-employed     -0.619841   0.371478  -1.669  0.09520 .  
jobservices          -0.318263   0.250425  -1.271  0.20377    
jobstudent           -0.043933   0.358261  -0.123  0.90240    
jobtechnician        -0.098825   0.190838  -0.518  0.60457    
jobunemployed        -0.272312   0.387289  -0.703  0.48198    
jobunknown           -0.273083   0.663572  -0.412  0.68068    
maritalmarried        0.183746   0.223584   0.822  0.41118    
maritalsingle         0.139063   0.256309   0.543  0.58743    
maritalunknown        0.695926   1.101316   0.632  0.52745    
defaultunknown        0.106330   0.188962   0.563  0.57363    
defaultyes           -9.163713 324.744062  -0.028  0.97749    
loanunknown          -0.317094   0.456788  -0.694  0.48757    
loanyes              -0.014684   0.170564  -0.086  0.93140    
contacttelephone     -1.024727   0.246424  -4.158 3.20e-05 ***
monthaug             -0.413356   0.356452  -1.160  0.24619    
monthdec              0.614229   0.575780   1.067  0.28607    
monthjul              0.184624   0.340892   0.542  0.58810    
monthjun              0.615757   0.305788   2.014  0.04404 *  
monthmar              1.377007   0.459132   2.999  0.00271 ** 
monthmay             -0.356948   0.259652  -1.375  0.16922    
monthnov             -0.179078   0.328507  -0.545  0.58567    
monthoct             -0.180101   0.423226  -0.426  0.67044    
monthsep             -0.541927   0.449870  -1.205  0.22835    
day_of_weekmon       -0.075330   0.198889  -0.379  0.70487    
day_of_weekthu       -0.016774   0.199455  -0.084  0.93298    
day_of_weektue       -0.004923   0.203467  -0.024  0.98070    
day_of_weekwed        0.075333   0.209499   0.360  0.71916    
campaign             -0.078924   0.037459  -2.107  0.03512 *  
previous              0.034627   0.182626   0.190  0.84962    
poutcomenonexistent   0.460538   0.294238   1.565  0.11754    
poutcomesuccess       1.074778   0.657424   1.635  0.10208    
cons.price.idx        0.694151   0.156180   4.445 8.81e-06 ***
cons.conf.idx         0.078603   0.017832   4.408 1.04e-05 ***
euribor3m            -0.569809   0.057506  -9.909  &lt; 2e-16 ***
pcontact              0.731795   0.657789   1.113  0.26592    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2314.9  on 3294  degrees of freedom
Residual deviance: 1805.4  on 3253  degrees of freedom
AIC: 1889.4

Number of Fisher Scoring iterations: 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m5.log) <span class="co"># double check multicollinearity, none left over 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF Df GVIF^(1/(2*Df))
age             1.974050  1        1.405009
job             2.310416 11        1.038799
marital         1.484554  3        1.068069
default         1.148681  2        1.035261
loan            1.053419  2        1.013095
contact         2.483993  1        1.576069
month           7.198369  9        1.115897
day_of_week     1.109219  4        1.013041
campaign        1.051852  1        1.025598
previous        4.667827  1        2.160515
poutcome       20.896601  2        2.138055
cons.price.idx  2.780227  1        1.667401
cons.conf.idx   2.710311  1        1.646302
euribor3m       2.865861  1        1.692885
pcontact        8.792808  1        2.965267</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the responses on the testing data. </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>predprob_log <span class="ot">&lt;-</span> <span class="fu">predict.glm</span>(m5.log, dftest, <span class="at">type =</span> <span class="st">"response"</span>)  <span class="do">## for logit</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>predclass_log <span class="ot">=</span> <span class="fu">ifelse</span>(predprob_log <span class="sc">&gt;=</span> <span class="fl">0.075</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to actual results using the confusion matrix. </span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predclass_log), <span class="fu">as.factor</span>(dftest<span class="sc">$</span>y), <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 506  25
         1 237  56
                                         
               Accuracy : 0.682          
                 95% CI : (0.649, 0.7137)
    No Information Rate : 0.9017         
    P-Value [Acc &gt; NIR] : 1              
                                         
                  Kappa : 0.1719         
                                         
 Mcnemar's Test P-Value : &lt;2e-16         
                                         
            Sensitivity : 0.69136        
            Specificity : 0.68102        
         Pos Pred Value : 0.19113        
         Neg Pred Value : 0.95292        
             Prevalence : 0.09830        
         Detection Rate : 0.06796        
   Detection Prevalence : 0.35558        
      Balanced Accuracy : 0.68619        
                                         
       'Positive' Class : 1              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#caret::confusionMatrix(as.factor(predclass_log_bal), dftest_bal$Attrition_Flag, positive = "Existing Customer")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>——HOLLY (skip to end of process , start m5 create new m6 chunk)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Resample with more balanced data </span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df_sub <span class="ot">=</span> df4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(y <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>df_no_sub <span class="ot">=</span> df4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(y <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>sample_no_sub <span class="ot">=</span> <span class="fu">sample_n</span>(df_no_sub, <span class="fu">nrow</span>(df_sub))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>df_bal <span class="ot">=</span> <span class="fu">rbind</span>(sample_no_sub,df_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing balanced samples</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>tr_ind_bal <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(df_bal), <span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(df_bal), <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="co"># Setting training sample to be 80% of the balanced data</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>dftrain_bal <span class="ot">&lt;-</span> df_bal[tr_ind_bal, ]</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>dftest_bal <span class="ot">&lt;-</span> df_bal[<span class="sc">-</span>tr_ind_bal, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Build model with balanced data</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>m6.log <span class="ot">=</span> <span class="fu">glm</span>(y <span class="sc">~</span> .<span class="sc">-</span> loan <span class="sc">-</span> emp.var.rate <span class="sc">-</span> euribor3m, <span class="at">data =</span> dftrain_bal, <span class="at">family =</span> binomial)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m6.log)  <span class="co"># Check the model summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ . - loan - emp.var.rate - euribor3m, family = binomial, 
    data = dftrain_bal)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   4.883e+01  2.151e+01   2.270  0.02322 *  
age                           1.967e-02  1.116e-02   1.762  0.07811 .  
jobblue-collar               -1.928e-01  3.408e-01  -0.566  0.57149    
jobentrepreneur              -4.849e-02  5.757e-01  -0.084  0.93287    
jobhousemaid                 -5.599e-01  7.154e-01  -0.783  0.43383    
jobmanagement                -2.677e-01  4.082e-01  -0.656  0.51189    
jobretired                   -4.212e-01  5.020e-01  -0.839  0.40144    
jobself-employed             -1.296e+00  5.491e-01  -2.360  0.01825 *  
jobservices                  -4.739e-01  3.854e-01  -1.230  0.21883    
jobstudent                   -7.336e-01  6.638e-01  -1.105  0.26909    
jobtechnician                -4.366e-01  3.118e-01  -1.400  0.16143    
jobunemployed                 3.690e-01  5.772e-01   0.639  0.52264    
jobunknown                   -2.782e-01  9.742e-01  -0.286  0.77521    
maritalmarried                1.055e-01  2.964e-01   0.356  0.72200    
maritalsingle                 4.129e-01  3.412e-01   1.210  0.22620    
maritalunknown                2.888e-01  1.304e+00   0.222  0.82470    
educationbasic.6y            -3.459e-01  4.967e-01  -0.696  0.48616    
educationbasic.9y             1.259e-01  3.929e-01   0.321  0.74858    
educationhigh.school         -1.203e-01  3.970e-01  -0.303  0.76185    
educationprofessional.course  5.362e-01  4.285e-01   1.251  0.21082    
educationuniversity.degree    1.941e-01  4.056e-01   0.478  0.63230    
educationunknown              1.692e-01  5.150e-01   0.329  0.74244    
defaultunknown                1.399e-01  2.594e-01   0.539  0.58967    
housingunknown               -1.050e+00  7.806e-01  -1.345  0.17875    
housingyes                   -6.178e-04  1.880e-01  -0.003  0.99738    
contacttelephone             -6.104e-01  3.655e-01  -1.670  0.09492 .  
monthaug                      3.423e-01  5.552e-01   0.617  0.53749    
monthdec                      6.053e-01  9.975e-01   0.607  0.54402    
monthjul                      6.047e-01  4.867e-01   1.243  0.21401    
monthjun                      1.187e+00  4.545e-01   2.612  0.00899 ** 
monthmar                      1.877e+00  8.466e-01   2.217  0.02664 *  
monthmay                      3.673e-02  3.744e-01   0.098  0.92184    
monthnov                      6.041e-02  4.788e-01   0.126  0.89959    
monthoct                      9.217e-01  7.447e-01   1.238  0.21582    
monthsep                     -8.813e-02  8.208e-01  -0.107  0.91449    
day_of_weekmon                7.882e-02  2.838e-01   0.278  0.78123    
day_of_weekthu                1.290e-01  2.940e-01   0.439  0.66081    
day_of_weektue                1.462e-01  2.903e-01   0.504  0.61445    
day_of_weekwed                3.188e-01  2.997e-01   1.064  0.28740    
campaign                     -9.367e-02  4.676e-02  -2.003  0.04518 *  
previous                      5.618e-01  5.839e-01   0.962  0.33596    
poutcomenonexistent           1.091e+00  7.153e-01   1.526  0.12711    
poutcomesuccess              -1.159e+01  6.069e+02  -0.019  0.98476    
cons.price.idx                3.130e-02  2.296e-01   0.136  0.89157    
cons.conf.idx                 1.385e-02  2.885e-02   0.480  0.63106    
nr.employed                  -1.038e-02  1.881e-03  -5.520 3.38e-08 ***
pcontact                      1.356e+01  6.069e+02   0.022  0.98217    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 999.48  on 720  degrees of freedom
Residual deviance: 744.91  on 674  degrees of freedom
AIC: 838.91

Number of Fisher Scoring iterations: 14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m6.log)  <span class="co"># Check multicollinearity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       GVIF Df GVIF^(1/(2*Df))
age            1.891110e+00  1        1.375176
job            7.985248e+00 11        1.099039
marital        1.562986e+00  3        1.077273
education      4.260623e+00  6        1.128382
default        1.168379e+00  1        1.080916
housing        1.182135e+00  2        1.042718
contact        3.301796e+00  1        1.817085
month          1.376500e+01  9        1.156819
day_of_week    1.352137e+00  4        1.038431
campaign       1.088522e+00  1        1.043323
previous       8.557917e+00  1        2.925392
poutcome       1.027350e+07  2       56.614751
cons.price.idx 2.472448e+00  1        1.572402
cons.conf.idx  2.478575e+00  1        1.574349
nr.employed    2.799338e+00  1        1.673122
pcontact       1.496701e+06  1     1223.397453</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the responses on the balanced testing data using the m6.log model</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>predprob_log_bal <span class="ot">&lt;-</span> <span class="fu">predict</span>(m6.log, dftest_bal, <span class="at">type =</span> <span class="st">"response"</span>)  <span class="co"># Predict probabilities for the test set</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>predclass_log_bal <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predprob_log_bal <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Classify based on the threshold</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the classification results</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">Predicted =</span> predclass_log_bal, <span class="at">Actual =</span> dftest_bal<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted  0  1
        0 73 37
        1 15 56</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to actual results using the confusion matrix</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predclass_log_bal), <span class="fu">as.factor</span>(dftest_bal<span class="sc">$</span>y), <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 73 37
         1 15 56
                                          
               Accuracy : 0.7127          
                 95% CI : (0.6409, 0.7774)
    No Information Rate : 0.5138          
    P-Value [Acc &gt; NIR] : 3.96e-08        
                                          
                  Kappa : 0.4288          
                                          
 Mcnemar's Test P-Value : 0.003589        
                                          
            Sensitivity : 0.6022          
            Specificity : 0.8295          
         Pos Pred Value : 0.7887          
         Neg Pred Value : 0.6636          
             Prevalence : 0.5138          
         Detection Rate : 0.3094          
   Detection Prevalence : 0.3923          
      Balanced Accuracy : 0.7158          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable selection - reduce model complexity using stepwise backward elimination</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>m7.log <span class="ot">=</span> <span class="fu">step</span>(<span class="fu">glm</span>(<span class="fu">as.factor</span>(y) <span class="sc">~</span> . <span class="sc">-</span> loan <span class="sc">-</span> emp.var.rate <span class="sc">-</span> euribor3m, <span class="at">data =</span> dftrain_bal, <span class="at">family =</span> binomial), <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=838.91
as.factor(y) ~ (age + job + marital + education + default + housing + 
    loan + contact + month + day_of_week + campaign + previous + 
    poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + 
    euribor3m + nr.employed + pcontact) - loan - emp.var.rate - 
    euribor3m

                 Df Deviance    AIC
- job            11   755.11 827.11
- education       6   749.92 831.92
- day_of_week     4   746.13 832.13
- marital         3   747.03 835.03
- cons.price.idx  1   744.93 836.93
- housing         2   746.97 836.97
- cons.conf.idx   1   745.14 837.14
- default         1   745.20 837.20
- previous        1   746.03 838.03
- pcontact        1   746.07 838.07
- poutcome        2   748.33 838.33
&lt;none&gt;                744.91 838.91
- contact         1   747.76 839.76
- age             1   748.03 840.03
- campaign        1   749.49 841.49
- month           9   766.39 842.39
- nr.employed     1   781.31 873.31

Step:  AIC=827.11
as.factor(y) ~ age + marital + education + default + housing + 
    contact + month + day_of_week + campaign + previous + poutcome + 
    cons.price.idx + cons.conf.idx + nr.employed + pcontact

                 Df Deviance    AIC
- day_of_week     4   756.04 820.04
- education       6   760.64 820.64
- marital         3   756.66 822.66
- cons.price.idx  1   755.11 825.11
- cons.conf.idx   1   755.28 825.28
- housing         2   757.39 825.39
- default         1   755.42 825.42
- pcontact        1   756.24 826.24
- previous        1   756.33 826.33
- poutcome        2   758.70 826.70
&lt;none&gt;                755.11 827.11
- contact         1   757.59 827.59
- age             1   759.10 829.10
- month           9   775.69 829.69
- campaign        1   760.25 830.25
- nr.employed     1   791.95 861.95

Step:  AIC=820.04
as.factor(y) ~ age + marital + education + default + housing + 
    contact + month + campaign + previous + poutcome + cons.price.idx + 
    cons.conf.idx + nr.employed + pcontact

                 Df Deviance    AIC
- education       6   761.86 813.86
- marital         3   757.63 815.63
- cons.price.idx  1   756.05 818.05
- cons.conf.idx   1   756.22 818.22
- default         1   756.31 818.31
- housing         2   758.48 818.48
- pcontact        1   757.16 819.16
- previous        1   757.29 819.29
- poutcome        2   759.67 819.67
&lt;none&gt;                756.04 820.04
- contact         1   758.55 820.55
- age             1   759.88 821.88
- month           9   777.35 823.35
- campaign        1   761.61 823.61
- nr.employed     1   792.53 854.53

Step:  AIC=813.86
as.factor(y) ~ age + marital + default + housing + contact + 
    month + campaign + previous + poutcome + cons.price.idx + 
    cons.conf.idx + nr.employed + pcontact

                 Df Deviance    AIC
- marital         3   763.68 809.68
- cons.price.idx  1   761.88 811.88
- default         1   761.96 811.96
- cons.conf.idx   1   762.13 812.13
- housing         2   764.23 812.23
- pcontact        1   763.03 813.03
- previous        1   763.11 813.11
- poutcome        2   765.51 813.51
&lt;none&gt;                761.86 813.86
- contact         1   764.31 814.31
- age             1   766.11 816.11
- month           9   782.86 816.86
- campaign        1   768.36 818.36
- nr.employed     1   799.24 849.24

Step:  AIC=809.68
as.factor(y) ~ age + default + housing + contact + month + campaign + 
    previous + poutcome + cons.price.idx + cons.conf.idx + nr.employed + 
    pcontact

                 Df Deviance    AIC
- cons.price.idx  1   763.71 807.71
- default         1   763.73 807.73
- cons.conf.idx   1   763.99 807.99
- housing         2   766.09 808.09
- pcontact        1   764.84 808.84
- previous        1   765.01 809.01
- poutcome        2   767.37 809.37
&lt;none&gt;                763.68 809.68
- contact         1   766.09 810.09
- age             1   766.39 810.39
- month           9   785.84 813.84
- campaign        1   769.87 813.87
- nr.employed     1   802.41 846.41

Step:  AIC=807.71
as.factor(y) ~ age + default + housing + contact + month + campaign + 
    previous + poutcome + cons.conf.idx + nr.employed + pcontact

                Df Deviance    AIC
- default        1   763.76 805.76
- cons.conf.idx  1   763.99 805.99
- housing        2   766.11 806.11
- pcontact       1   764.85 806.85
- previous       1   765.12 807.12
- poutcome       2   767.55 807.55
&lt;none&gt;               763.71 807.71
- age            1   766.40 808.40
- contact        1   766.46 808.46
- campaign       1   769.87 811.87
- month          9   788.29 814.29
- nr.employed    1   802.46 844.46

Step:  AIC=805.76
as.factor(y) ~ age + housing + contact + month + campaign + previous + 
    poutcome + cons.conf.idx + nr.employed + pcontact

                Df Deviance    AIC
- cons.conf.idx  1   764.06 804.06
- housing        2   766.16 804.16
- pcontact       1   764.91 804.91
- previous       1   765.19 805.19
- poutcome       2   767.65 805.65
&lt;none&gt;               763.76 805.76
- contact        1   766.51 806.51
- age            1   766.67 806.67
- campaign       1   769.98 809.98
- month          9   788.30 812.30
- nr.employed    1   802.83 842.83

Step:  AIC=804.06
as.factor(y) ~ age + housing + contact + month + campaign + previous + 
    poutcome + nr.employed + pcontact

              Df Deviance    AIC
- housing      2   766.53 802.53
- pcontact     1   765.26 803.26
- previous     1   765.51 803.51
- poutcome     2   767.95 803.95
&lt;none&gt;             764.06 804.06
- contact      1   766.57 804.57
- age          1   766.97 804.97
- campaign     1   770.22 808.22
- month        9   789.23 811.23
- nr.employed  1   805.44 843.44

Step:  AIC=802.53
as.factor(y) ~ age + contact + month + campaign + previous + 
    poutcome + nr.employed + pcontact

              Df Deviance    AIC
- previous     1   767.62 801.62
- pcontact     1   767.94 801.94
- poutcome     2   770.29 802.29
&lt;none&gt;             766.53 802.53
- age          1   769.18 803.18
- contact      1   769.50 803.50
- campaign     1   772.45 806.45
- month        9   790.98 808.98
- nr.employed  1   807.99 841.99

Step:  AIC=801.62
as.factor(y) ~ age + contact + month + campaign + poutcome + 
    nr.employed + pcontact

              Df Deviance    AIC
- poutcome     2   771.06 801.06
&lt;none&gt;             767.62 801.62
- age          1   770.27 802.27
- contact      1   770.41 802.41
- pcontact     1   770.65 802.65
- campaign     1   773.54 805.54
- month        9   792.92 808.92
- nr.employed  1   812.12 844.12

Step:  AIC=801.06
as.factor(y) ~ age + contact + month + campaign + nr.employed + 
    pcontact

              Df Deviance    AIC
&lt;none&gt;             771.06 801.06
- contact      1   773.38 801.38
- age          1   773.64 801.64
- campaign     1   777.12 805.12
- month        9   797.29 809.29
- pcontact     1   788.85 816.85
- nr.employed  1   812.71 840.71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the summary and VIF of the final model</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m7.log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = as.factor(y) ~ age + contact + month + campaign + 
    nr.employed + pcontact, family = binomial, data = dftrain_bal)

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      48.706620   8.171565   5.961 2.51e-09 ***
age               0.012996   0.008159   1.593 0.111188    
contacttelephone -0.408616   0.268499  -1.522 0.128046    
monthaug          0.469097   0.409848   1.145 0.252390    
monthdec          0.505752   0.881509   0.574 0.566147    
monthjul          0.647060   0.413096   1.566 0.117263    
monthjun          1.081414   0.414388   2.610 0.009063 ** 
monthmar          1.789458   0.820782   2.180 0.029244 *  
monthmay         -0.073644   0.351233  -0.210 0.833923    
monthnov          0.113763   0.425928   0.267 0.789396    
monthoct          1.004064   0.668790   1.501 0.133274    
monthsep          0.102028   0.740559   0.138 0.890421    
campaign         -0.105242   0.046475  -2.264 0.023544 *  
nr.employed      -0.009619   0.001603  -5.999 1.98e-09 ***
pcontact          1.809398   0.502590   3.600 0.000318 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 999.48  on 720  degrees of freedom
Residual deviance: 771.06  on 706  degrees of freedom
AIC: 801.06

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m7.log)  <span class="co"># Double-check multicollinearity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                GVIF Df GVIF^(1/(2*Df))
age         1.034835  1        1.017269
contact     1.833075  1        1.353911
month       2.883726  9        1.060603
campaign    1.039624  1        1.019619
nr.employed 2.138719  1        1.462436
pcontact    1.110850  1        1.053969</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the responses on the balanced testing data using the reduced model</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>predprob2_log_bal <span class="ot">&lt;-</span> <span class="fu">predict</span>(m7.log, <span class="at">newdata =</span> dftest_bal, <span class="at">type =</span> <span class="st">"response"</span>)  <span class="co"># Predict probabilities for the test set</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>predclass2_log_bal <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predprob2_log_bal <span class="sc">&gt;=</span> <span class="fl">0.35</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Classify based on the threshold</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to actual results using the confusion matrix</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predclass2_log_bal), <span class="fu">as.factor</span>(dftest_bal<span class="sc">$</span>y), <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 58 22
         1 30 71
                                          
               Accuracy : 0.7127          
                 95% CI : (0.6409, 0.7774)
    No Information Rate : 0.5138          
    P-Value [Acc &gt; NIR] : 3.96e-08        
                                          
                  Kappa : 0.4236          
                                          
 Mcnemar's Test P-Value : 0.3317          
                                          
            Sensitivity : 0.7634          
            Specificity : 0.6591          
         Pos Pred Value : 0.7030          
         Neg Pred Value : 0.7250          
             Prevalence : 0.5138          
         Detection Rate : 0.3923          
   Detection Prevalence : 0.5580          
      Balanced Accuracy : 0.7113          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ROC Curve and AUC</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>pred_bal <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predprob2_log_bal,dftest_bal<span class="sc">$</span>y) <span class="co">#Predicted Probability and True Classification</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># area under curve</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>auc_bal <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">performance</span>(pred_bal, <span class="at">measure =</span> <span class="st">"auc"</span>)<span class="sc">@</span>y.values),<span class="dv">3</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting the ROC curve and computing AUC</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>perf_bal <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_bal, <span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf_bal,<span class="at">colorize =</span> T, <span class="at">main =</span> <span class="st">"ROC Curve Balanced"</span>)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>, <span class="fu">paste</span>(<span class="st">"AUC:"</span>, auc_bal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># computing threshold for cutoff to best trade off sensitivity and specificity, unbalanced first</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#first sensitivity</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"sens"</span>)<span class="sc">@</span>x.values), <span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"sens"</span>)<span class="sc">@</span>y.values), </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">xlab=</span><span class="st">"Cutoff"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Maximized Cutoff</span><span class="sc">\n</span><span class="st">"</span>,<span class="st">"AUC: "</span>,auc_bal))</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>) <span class="co"># plot another line in same plot</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co">#second specificity</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"spec"</span>)<span class="sc">@</span>x.values), <span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"spec"</span>)<span class="sc">@</span>y.values), </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>)) <span class="co">#specificity axis labels</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Specificity"</span>,<span class="at">side=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co">#find where the lines intersect</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>min.diff_bal <span class="ot">&lt;-</span><span class="fu">which.min</span>(<span class="fu">abs</span>(<span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"sens"</span>)<span class="sc">@</span>y.values) <span class="sc">-</span> <span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"spec"</span>)<span class="sc">@</span>y.values)))</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>min.x_bal<span class="ot">&lt;-</span><span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"sens"</span>)<span class="sc">@</span>x.values)[min.diff_bal]</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>min.y_bal<span class="ot">&lt;-</span><span class="fu">unlist</span>(<span class="fu">performance</span>(pred_bal, <span class="st">"spec"</span>)<span class="sc">@</span>y.values)[min.diff_bal]</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>optimal_bal <span class="ot">&lt;-</span>min.x_bal <span class="co">#this is the optimal points to best trade off sensitivity and specificity</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> min.y_bal, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> min.x_bal, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(min.x_bal,<span class="dv">0</span>,<span class="fu">paste</span>(<span class="st">"optimal threshold="</span>,<span class="fu">round</span>(optimal_bal,<span class="dv">2</span>)), <span class="at">pos =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Case_Study_1_Sandbox_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pr_class_bal <span class="ot">=</span> <span class="fu">ifelse</span>(predprob2_log_bal<span class="sc">&gt;</span>optimal_bal, <span class="dv">1</span>,<span class="dv">0</span>) <span class="co">#use the optimal cutoff to classify</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(pr_class_bal),<span class="fu">as.factor</span>(dftest_bal<span class="sc">$</span>y)) <span class="co">#this function and package auto computes a lot of the metrics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 65 25
         1 23 68
                                          
               Accuracy : 0.7348          
                 95% CI : (0.6642, 0.7975)
    No Information Rate : 0.5138          
    P-Value [Acc &gt; NIR] : 1.001e-09       
                                          
                  Kappa : 0.4695          
                                          
 Mcnemar's Test P-Value : 0.8852          
                                          
            Sensitivity : 0.7386          
            Specificity : 0.7312          
         Pos Pred Value : 0.7222          
         Neg Pred Value : 0.7473          
             Prevalence : 0.4862          
         Detection Rate : 0.3591          
   Detection Prevalence : 0.4972          
      Balanced Accuracy : 0.7349          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
<section id="lda" class="level3">
<h3 class="anchored" data-anchor-id="lda">LDA</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>m1.lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(y <span class="sc">~</span> .<span class="sc">-</span> loan <span class="sc">-</span> emp.var.rate <span class="sc">-</span> euribor3m, <span class="at">data =</span> dftrain)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>m1.lda <span class="do">## look at results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(y ~ . - loan - emp.var.rate - euribor3m, data = dftrain)

Prior probabilities of groups:
        0         1 
0.8877086 0.1122914 

Group means:
       age jobblue-collar jobentrepreneur jobhousemaid jobmanagement jobretired
0 39.78564      0.2263248      0.03760684   0.02735043    0.08205128 0.03213675
1 41.48108      0.1324324      0.01891892   0.02972973    0.06486486 0.07837838
  jobself-employed jobservices jobstudent jobtechnician jobunemployed
0       0.04170940  0.09641026 0.01709402     0.1637607    0.02529915
1       0.02972973  0.07567568 0.04594595     0.1756757    0.03513514
   jobunknown maritalmarried maritalsingle maritalunknown educationbasic.6y
0 0.008205128      0.6157265     0.2724786    0.003076923        0.05264957
1 0.010810811      0.5675676     0.3351351    0.002702703        0.03513514
  educationbasic.9y educationhigh.school educationilliterate
0        0.14666667            0.2276923        0.0003418803
1        0.09459459            0.2108108        0.0000000000
  educationprofessional.course educationuniversity.degree educationunknown
0                    0.1247863                  0.2981197       0.04239316
1                    0.1378378                  0.3810811       0.05135135
  defaultunknown   defaultyes housingunknown housingyes contacttelephone
0      0.2023932 0.0003418803     0.02564103  0.5367521        0.3784615
1      0.1189189 0.0000000000     0.01891892  0.5432432        0.1594595
   monthaug    monthdec  monthjul  monthjun    monthmar  monthmay  monthnov
0 0.1524786 0.003418803 0.1688889 0.1264957 0.005811966 0.3562393 0.1131624
1 0.1432432 0.029729730 0.1270270 0.1486486 0.048648649 0.2108108 0.1027027
    monthoct   monthsep day_of_weekmon day_of_weekthu day_of_weektue
0 0.01264957 0.01094017      0.2068376      0.2119658      0.2003419
1 0.05945946 0.05405405      0.2270270      0.2135135      0.2054054
  day_of_weekwed campaign  previous poutcomenonexistent poutcomesuccess
0      0.1904274 2.604786 0.1456410           0.8779487      0.01230769
1      0.1702703 1.983784 0.5594595           0.6540541      0.18378378
  cons.price.idx cons.conf.idx nr.employed   pcontact
0       93.59394     -40.63993    5174.850 0.01470085
1       93.38289     -39.76054    5093.636 0.20270270

Coefficients of linear discriminants:
                                      LD1
age                           0.007716309
jobblue-collar               -0.278959139
jobentrepreneur              -0.292538834
jobhousemaid                 -0.100978777
jobmanagement                -0.383550878
jobretired                   -0.050814422
jobself-employed             -0.398897801
jobservices                  -0.159639063
jobstudent                   -0.065079732
jobtechnician                -0.090786325
jobunemployed                -0.179550982
jobunknown                   -0.120141769
maritalmarried                0.068578192
maritalsingle                 0.050638080
maritalunknown                0.319299259
educationbasic.6y             0.099232214
educationbasic.9y             0.038308958
educationhigh.school         -0.031407314
educationilliterate          -2.196389290
educationprofessional.course  0.127901535
educationuniversity.degree    0.098526110
educationunknown             -0.007859312
defaultunknown                0.052568263
defaultyes                    0.014086039
housingunknown               -0.178422672
housingyes                   -0.051387146
contacttelephone             -0.727449392
monthaug                     -0.431878383
monthdec                      0.585886372
monthjul                      0.266566419
monthjun                      0.685613936
monthmar                      1.692018652
monthmay                     -0.367644548
monthnov                     -0.170076111
monthoct                     -0.530723508
monthsep                     -1.180324920
day_of_weekmon               -0.065216029
day_of_weekthu               -0.002055912
day_of_weektue               -0.005720756
day_of_weekwed                0.042655758
campaign                     -0.027554326
previous                      0.075387611
poutcomenonexistent           0.383889164
poutcomesuccess               1.470174470
cons.price.idx                0.276641016
cons.conf.idx                 0.082839001
nr.employed                  -0.011641589
pcontact                      1.114852638</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>m2.lda_bal <span class="ot">&lt;-</span> <span class="fu">lda</span>(y <span class="sc">~</span> .<span class="sc">-</span>housing <span class="sc">-</span>nr.employed <span class="sc">-</span>emp.var.rate <span class="sc">-</span>education <span class="sc">-</span>default, <span class="at">data =</span> dftrain_bal)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>m2.lda_bal <span class="do">## look at results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(y ~ . - housing - nr.employed - emp.var.rate - education - 
    default, data = dftrain_bal)

Prior probabilities of groups:
        0         1 
0.5034674 0.4965326 

Group means:
       age jobblue-collar jobentrepreneur jobhousemaid jobmanagement jobretired
0 39.81267      0.2258953      0.03030303   0.02203857    0.05509642 0.04683196
1 42.03911      0.1424581      0.01955307   0.01675978    0.06145251 0.08379888
  jobself-employed jobservices jobstudent jobtechnician jobunemployed
0       0.05234160  0.11570248 0.01652893     0.1845730    0.02203857
1       0.02513966  0.07541899 0.03631285     0.1731844    0.05307263
   jobunknown maritalmarried maritalsingle maritalunknown loanunknown   loanyes
0 0.008264463      0.5895317     0.2865014    0.005509642  0.02479339 0.1707989
1 0.011173184      0.5474860     0.3463687    0.002793296  0.01675978 0.1648045
  contacttelephone  monthaug    monthdec  monthjul  monthjun    monthmar
0        0.3636364 0.1652893 0.005509642 0.1873278 0.1404959 0.005509642
1        0.1648045 0.1424581 0.022346369 0.1284916 0.1592179 0.058659218
   monthmay   monthnov   monthoct    monthsep day_of_weekmon day_of_weekthu
0 0.3168044 0.09917355 0.01101928 0.008264463       0.214876      0.1735537
1 0.1955307 0.10055866 0.06145251 0.053072626       0.226257      0.1983240
  day_of_weektue day_of_weekwed campaign  previous poutcomenonexistent
0      0.2093664      0.1680441 2.768595 0.1322314           0.8787879
1      0.2067039      0.1759777 1.980447 0.5977654           0.6312849
  poutcomesuccess cons.price.idx cons.conf.idx euribor3m  pcontact
0       0.0137741       93.61255     -40.60496  3.822501 0.0137741
1       0.2262570       93.42659     -39.76425  2.138874 0.2402235

Coefficients of linear discriminants:
                            LD1
age                  0.01566172
jobblue-collar      -0.29277911
jobentrepreneur     -0.05201150
jobhousemaid        -0.51506486
jobmanagement       -0.20198067
jobretired          -0.43743294
jobself-employed    -0.92371820
jobservices         -0.48589967
jobstudent          -0.46057757
jobtechnician       -0.18897342
jobunemployed        0.23033322
jobunknown          -0.15078677
maritalmarried       0.15366330
maritalsingle        0.35102476
maritalunknown       0.08828312
loanunknown         -0.69942387
loanyes             -0.10151646
contacttelephone    -0.39836341
monthaug             0.42192247
monthdec             0.51304028
monthjul             0.61959217
monthjun             0.87151799
monthmar             1.27737213
monthmay             0.10112116
monthnov             0.37521177
monthoct             0.94587558
monthsep             0.42399639
day_of_weekmon       0.13943133
day_of_weekthu       0.18120688
day_of_weektue       0.16943107
day_of_weekwed       0.31632714
campaign            -0.07201080
previous             0.03594890
poutcomenonexistent  0.48128754
poutcomesuccess     -0.10326496
cons.price.idx       0.39043778
cons.conf.idx        0.03236432
euribor3m           -0.49593510
pcontact             1.15994156</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the responses on the balanced and unbalanced testing data. </span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>predclass_lda <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1.lda, dftest)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>predclass_lda_bal <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2.lda_bal, dftest_bal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to actual results using the confusion matrix. </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predclass_lda<span class="sc">$</span>class), <span class="fu">as.factor</span>(dftest<span class="sc">$</span>y), <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 700  41
         1  43  40
                                          
               Accuracy : 0.8981          
                 95% CI : (0.8753, 0.9179)
    No Information Rate : 0.9017          
    P-Value [Acc &gt; NIR] : 0.6637          
                                          
                  Kappa : 0.4312          
                                          
 Mcnemar's Test P-Value : 0.9131          
                                          
            Sensitivity : 0.49383         
            Specificity : 0.94213         
         Pos Pred Value : 0.48193         
         Neg Pred Value : 0.94467         
             Prevalence : 0.09830         
         Detection Rate : 0.04854         
   Detection Prevalence : 0.10073         
      Balanced Accuracy : 0.71798         
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predclass_lda_bal<span class="sc">$</span>class), <span class="fu">as.factor</span>(dftest_bal<span class="sc">$</span>y), <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 74 37
         1 14 56
                                          
               Accuracy : 0.7182          
                 95% CI : (0.6467, 0.7825)
    No Information Rate : 0.5138          
    P-Value [Acc &gt; NIR] : 1.643e-08       
                                          
                  Kappa : 0.44            
                                          
 Mcnemar's Test P-Value : 0.002066        
                                          
            Sensitivity : 0.6022          
            Specificity : 0.8409          
         Pos Pred Value : 0.8000          
         Neg Pred Value : 0.6667          
             Prevalence : 0.5138          
         Detection Rate : 0.3094          
   Detection Prevalence : 0.3867          
      Balanced Accuracy : 0.7215          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>