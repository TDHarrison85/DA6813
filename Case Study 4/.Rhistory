pacman::p_load(survival, randomForestSRC, MASS, SMCRM, tidyverse, here, skimr, corrplot, rpart)
data(acquisitionRetention)
rawdf <- acquisitionRetention
str(rawdf)
head(rawdf)
rawdf %>% select_if(is.numeric) %>% cor() %>% corrplot(method = 'number', number.cex = 0.6)
# Survival Plot
surv <- data.frame(duration = seq(0,max(rawdf$duration), by = 1))
surv1 <- surv %>%
group_by(duration) %>%
mutate(dist = sum(rawdf$duration > duration))
#greater than removes all of the results where duration == 0, i.e. those not acquired
surv1 %>% ggplot(aes(x = duration, y = dist)) +
geom_line() +
scale_y_continuous(name = 'Count', sec.axis = sec_axis(trans = ~./max(surv1$dist), name = 'Distribution'))
surv2 <- surv1 %>%
ungroup() %>%
mutate(dens = dist - lead(dist, 1),
dens = ifelse(is.na(dens), 0, dens),
hazard = dens/dist,
dens2 = dens/max(dist)
)
surv2 %>% ggplot(aes(x = duration, y = dens2)) +
geom_line()
?acquisitionRetention
