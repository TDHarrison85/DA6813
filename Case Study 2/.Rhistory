pacman::p_load(tidyverse, e1071, here, readxl, skimr, corrplot, patchwork)
raw_train <- read_xlsx(here('Case Study 2', 'BBBC-Train.xlsx'))
raw_test <- read_xlsx(here('Case Study 2', 'BBBC-Test.xlsx'))
str(raw_train)
anyNA(raw_train)
skim(raw_train)
train1 <- raw_train %>%
select(-Observation) %>%
mutate(
Choice = as.factor(Choice),
Gender = as.factor(Gender)
)
test1 <- raw_test %>%
select(-Observation) %>%
mutate(
Choice = as.factor(Choice),
Gender = as.factor(Gender)
)
combined <- rbind(train1, test1)
combined %>% select_if(is.numeric) %>% cor() %>% corrplot(method = 'number')
combined %>% mutate(
Gender = ifelse(Gender == 0, 'Female', 'Male'),
Choice = ifelse(Choice == 0, 'Non-purchase', 'purchase')
) %>%
ggplot(aes(x = Gender, fill = Choice)) +
geom_bar() + ggtitle('Gender vs Purchase')
combox <- lapply(colnames(select_if(combined, is.numeric)),
function(col) {
ggplot(combined,
aes(y = .data[[col]], x = .data$Choice)) + geom_boxplot() + ggtitle(col)
}
)
combox[[1]] + combox[[2]] + combox[[3]]
combox[[4]] + combox[[5]] + combox[[6]]
combox[[7]] + combox[[8]] + combox[[9]]
combbar <- lapply(colnames(select_if(combined, startsWith(names(combined), 'P_'))),
function(col) {
ggplot(combined,
aes(x = .data[[col]], fill = .data$Choice)) + geom_bar(position = 'dodge') +
ggtitle(col) +
theme(legend.position = c(0.8,0.8), legend.background = element_blank())
}
)
combbar[[1]] + combbar[[2]]
combbar[[3]] + combbar[[4]]
combbar[[5]]
combined %>% group_by(Choice, P_Art) %>%
summarize(cnt = n()) %>% pivot_wider(id_cols = P_Art, names_from = Choice, values_from = cnt)
set.seed(321)
form1 <- Choice ~ .
svmtune <- tune.svm(form1, data = train1, gamma = seq(.01,.1, by = .01), cost = seq(.1, 1, by = .1))
set.seed(321)
form1 <- Choice ~ .
resultsLM= lm(form1, data = train1)
predLM = predict(resultsLM, newdata=test1)
mean((predLM - test1$Choice)^2)
set.seed(321)
form1 <- Choice ~ .
resultsLM= lm(Choice ~.), data = train1)
set.seed(321)
form1 <- Choice ~ .
resultsLM= lm(Choice ~ ., data = train1)
predLM = predict(resultsLM, newdata=test1)
mean((predLM - train1$Choice)^2)
set.seed(321)
form1 <- Choice ~ .
resultsLM= lm(Choice ~ ., data = train1)
summary(resultsLM)
set.seed(321)
form1 <- Choice ~ .
resultsLM<- lm(Choice ~ ., data = train1)
summary(resultsLM)
set.seed(321)
form1 <- Choice ~ .
resultsLM <- lm(Choice ~ ., data = train1)
summary(resultsLM)
View(resultsLM)
resultsLM <- lm(Choice ~ ., data = train1)
summary(resultsLM)
View(test1)
lmtrain1$Choice <- as.numeric(as.character(train1$Choice))
#Creating data frames that don't make Choice a factor only to run Linear Regression. This is done to show it isn't the appropriate model.
linregtrain1 <- raw_train %>%
select(-Observation) %>%
mutate(
Gender = as.factor(Gender)
)
linreg1 <- raw_test %>%
select(-Observation) %>%
mutate(
Gender = as.factor(Gender)
)
combined <- rbind(linregtrain1, linregtest1)
#Creating data frames that don't make Choice a factor only to run Linear Regression. This is done to show it isn't the appropriate model.
linregtrain1 <- raw_train %>%
select(-Observation) %>%
mutate(
Gender = as.factor(Gender)
)
linregtest1 <- raw_test %>%
select(-Observation) %>%
mutate(
Gender = as.factor(Gender)
)
combined <- rbind(linregtrain1, linregtest1)
resultsLinReg <- lm(Choice ~ ., data = linregtrain1)
summary(resultsLinReg)
